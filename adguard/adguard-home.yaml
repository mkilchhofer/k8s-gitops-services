---
apiVersion: helm.fluxcd.io/v1
kind: HelmRelease
metadata:
  name: adguard-home
  namespace: adguard
spec:
  releaseName: adguard-home
  chart:
    repository: https://billimek.com/billimek-charts/
    name: adguard-home
    version: "1.0.0"
  values:
    ingress:
      enabled: true
      annotations:
        kubernetes.io/ingress.class: traefik-internal
        traefik.ingress.kubernetes.io/redirect-entry-point: https
        cert-manager.io/cluster-issuer: letsencrypt
      path: /
      hosts:
        - adguard.tools.kilchhofer.info
      tls:
        - secretName: adguard-cert
          hosts:
            - adguard.tools.kilchhofer.info

    serviceTCP:
      enabled: true
      type: LoadBalancer
      externalTrafficPolicy: Local
      loadBalancerIP: "192.168.93.84"
      annotations:
        metallb.universe.tf/allow-shared-ip: adguard

    serviceUDP:
      enabled: true
      type: LoadBalancer
      externalTrafficPolicy: Local
      loadBalancerIP: "192.168.93.84"
      annotations:
        metallb.universe.tf/allow-shared-ip: adguard
